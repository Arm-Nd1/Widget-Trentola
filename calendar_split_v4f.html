<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Calendario Split v4f — finale con auto-update</title>
<style>
  :root{
    --text:#e6edf3; --muted:#9aa7b3;
    --accent:#6f3cff; --accent2:#6f3cff;
    --bgAlpha:0; --todayBg:#ffffff; --todayFg:#0a0c10;
    --shift:60px;   /* sposta GRIGLIA (a destra) verso il basso */
    --underline:4px;/* spessore linea settimanale */
    --gapV:14px;    /* spazio fra settimane */
    --gapH:10px;    /* spazio fra giorni */
    --bigSize:128px;/* dimensione numero grande */
    --dowX:0px; --dowY:165px; --bigShift:0px; --monthShift:-150px;
  }
  html,body{height:100%;margin:0;color:var(--text);font:16px system-ui}
  body{background:#0a0c10}
  .wrap{height:100%;padding:12px;box-sizing:border-box}
  .card{height:100%;border-radius:18px;background:rgba(10,12,16,var(--bgAlpha));
        display:grid;grid-template-columns: 0.42fr 0.58fr;gap:18px;overflow:hidden}
  /* LEFT = big day */
  .left{padding:16px; display:grid; grid-template-rows: auto 1fr auto; align-items:center}
  .dow{font-weight:900;letter-spacing:.35px;color:#f2c94c;
       text-transform:uppercase;text-shadow:0 1px 2px rgba(0,0,0,.6);
       transform: translate(var(--dowX),var(--dowY));}
  .big{justify-self:center;font-size:var(--bigSize);line-height:.9;font-weight:900;
       letter-spacing:1px;text-shadow:0 2px 6px rgba(0,0,0,.5);color:var(--text);
       transform: translateY(var(--bigShift));}
  .monthyear{justify-self:center;font-weight:800;color:#f2c94c;
             text-transform:uppercase;letter-spacing:.6px;text-shadow:0 1px 2px rgba(0,0,0,.5);
             transform: translateY(var(--monthShift));}
  /* RIGHT = grid */
  .right{padding:16px; display:flex; flex-direction:column}
  .rightInner{margin-top:var(--shift);}
  .dows{display:grid;grid-template-columns:repeat(7,1fr);gap:var(--gapH);margin-bottom:8px}
  .dowCell{font-size:13px;color:var(--muted);text-align:center;text-transform:uppercase;
           text-shadow:0 1px 2px rgba(0,0,0,.35)}
  .dows .dowCell:first-child,
  .dows .dowCell:last-child{ color:#f2c94c; font-weight:900; }
  .weeks{display:flex;flex-direction:column;gap:var(--gapV)}
  .week{position:relative;display:grid;grid-template-columns:repeat(7,1fr);gap:var(--gapH)}
  .underline{position:absolute;left:4px;right:4px;bottom:calc(var(--underline) * -0.8);
             height:var(--underline);border-radius:var(--underline);
             background:linear-gradient(90deg,var(--accent),var(--accent2));opacity:.95}
  .day{padding:10px 0;text-align:center;border-radius:12px;border:1px solid transparent;
       font-size:22px;text-shadow:0 1px 2px rgba(0,0,0,.55);}
  .dim{opacity:.35}
  .sun,.sat{color:#f2c94c}
  .today{background:var(--todayBg);color:var(--todayFg);font-weight:900;
         box-shadow:0 2px 10px rgba(0,0,0,.25)}
</style>
</head>
<body>
<div class="wrap">
  <div class="card" id="card">
    <div class="left">
      <div class="dow" id="dowFull">—</div>
      <div class="big" id="bigNum">--</div>
      <div class="monthyear" id="monthYear">—</div>
    </div>
    <div class="right">
      <div class="rightInner">
        <div class="dows" id="dows"></div>
        <div class="weeks" id="weeks"></div>
      </div>
    </div>
  </div>
</div>
<script>
const qs=new URLSearchParams(location.search);
const scale=Math.max(0.8,Math.min(1.8,parseFloat(qs.get('scale'))||1.2));
document.documentElement.style.fontSize=(16*scale)+'px';
function setpx(vname,val){if(val===null)return;const n=String(val).trim();if(/^-?\\d+$/.test(n))document.documentElement.style.setProperty(vname,n+'px');}
setpx('--shift',qs.get('shift'));setpx('--dowY',qs.get('dowY'));setpx('--dowX',qs.get('dowX'));
setpx('--monthShift',qs.get('month'));setpx('--bigShift',qs.get('bigShift'));
function render(date){
  const dowFull=date.toLocaleDateString('it-IT',{weekday:'long'}).toUpperCase();
  const big=date.getDate();
  const monthYear=(date.toLocaleDateString('it-IT',{month:'long'})+' '+date.getFullYear()).toUpperCase();
  document.getElementById('dowFull').textContent=dowFull;
  document.getElementById('bigNum').textContent=big;
  document.getElementById('monthYear').textContent=monthYear;
  const dows=['D','L','M','M','G','V','S'];
  document.getElementById('dows').innerHTML=dows.map(x=>`<div class="dowCell">${x}</div>`).join('');
  const y=date.getFullYear(),m=date.getMonth();
  const first=new Date(y,m,1),last=new Date(y,m+1,0),prevLast=new Date(y,m,0);
  const start=first.getDay(),total=start+last.getDate(),cells=Math.ceil(total/7)*7,today=new Date();
  let weeksHTML='';
  for(let r=0;r<cells/7;r++){
    let row='';
    for(let c=0;c<7;c++){
      const i=r*7+c,dayNum=i-start+1;let d,cls='day';
      if(i<start){d=new Date(y,m-1,prevLast.getDate()-start+i+1);cls+=' dim';}
      else if(dayNum>last.getDate()){d=new Date(y,m+1,dayNum-last.getDate());cls+=' dim';}
      else{d=new Date(y,m,dayNum);if(d.toDateString()===today.toDateString())cls+=' today';}
      if(c===0)cls+=' sun';if(c===6)cls+=' sat';
      row+=`<div class="${cls}">${d.getDate()}</div>`;
    }
    weeksHTML+=`<div class="week">${row}<div class="underline"></div></div>`;
  }
  document.getElementById('weeks').innerHTML=weeksHTML;
}
render(new Date());

// Auto-update at midnight
setInterval(()=>{
  const now=new Date();
  if(now.getHours()===0 && now.getMinutes()<2){
    render(now);
  }
},60000);
</script>
</body>
</html>
